# Understanding How Project Geospatial Features are Derived from OpenStreetMap

Many projects in AidData's Global Chinese Development Finance Dataset which have a physical footprint - such as roads, airports, power plants, or hospitals - have been mapped using [OpenStreetMap (OSM)](https://www.openstreetmap.org). OpenStreetMap is a free, editable map of the whole world that is being built by volunteers largely from scratch and released with an open-content license ([wiki](https://wiki.openstreetmap.org)). For projects with a physical footprint, AidData either searches the OSM database for existing features (e.g., [Wattay International Airport](https://www.openstreetmap.org/relation/12306335) in Laos) or generates driving directions associated with road projects (e.g., the [N’Zeto-Soyo Highway Project](https://www.openstreetmap.org/directions?engine=fossgis_osrm_car&route=-7.2316%2C12.8685%3B-6.1334%2C12.3718#map=9/-6.6823/12.6233) in Angola). Once one or more features are found (or directions generated) which are associated with a project, the web links to the associated pages are saved so that the geospatial features can be extracted.

<img alt="Wattay International Airport, Laos" src="laos_airport.png" height="500">
<img alt="N’Zeto-Soyo Highway Project, Angola" src="angola_highway.png" height="500">

Before features can be extracted from OSM pages, we must understand the different types of data available through OSM. OSM features consist of 3 elements: [nodes, ways, and relations](https://wiki.openstreetmap.org/wiki/Elements). Driving directions will be treated as a separate fourth type that we address shortly. Nodes define points, ways define linear features (i.e., a line) or area boundaries (i.e., a polygon), while relations are a more complex description of how other elements can be combined together. Relations can include various combinations of nodes, ways, and other relations as members. Given the nature of relations, and since an individual project may consist of multiple OSM features, it is common that multiple geospatial feature types (points, lines, polygons, and multi-feature versions of each) are associated with a single project. This presents a challenge when attempting to produce a uniform data model for our dataset.

To overcome this issue, all point and line features are buffered slightly (approximately one meter) to transform them into polygons. To account for multiple features - all of which are now polygons - associated with a single project, a single multi-polygon feature is created which combines the polygons. In order to avoid producing invalid geometries, such as ones that have self-intersections, all polygons associated with a project are [dissolved](http://wiki.gis.com/wiki/index.php/Dissolve) prior to generating the final MultiPolygon. [ESRI's ArcGIS Resource Center](https://help.arcgis.com/en/geodatabase/10.0/sdk/arcsde/concepts/geometry/shapes/types.htm) provides additional details on these types of geospatial features.

<img alt="Separate Point, LineString, and Polygon features" src="separate_shapes.png" height="300">
<img alt="Combined MultiPolygon" src="merged_multipolygon.png" height="300">

The final collection of MultiPolygons is then exported using the [GeoJSON](https://geojson.org/) and [GeoPackage](https://www.geopackage.org/) file formats for geospatial data.
